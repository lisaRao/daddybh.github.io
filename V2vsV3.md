内嵌站首页（越狱）改版数据对比
=======
以下是越狱应用首页，在无缓存情况下，使用chrome浏览器的对比数据

此数据使用chrome在浏览器测试，因此仅作参考对比

内嵌页使用IE内核，与chrome性能差别较大


新版:  http://pppc2.25pp.com/jb_app_v2/#u_home 

旧版： http://pppc2.25pp.com/jb_app/#u_home 

####请求数####

|        |新版   | 旧版             | 增长比例 |
|------- |-------|----------------  |  -----   |
|请求数  | 120  | 90 |  33.3%   |
|js      | 5    | 7  |  -28.5%  |
|css     | 1    | 1  |  0%      |
|图片    | 95   | 71 |  33.8%   |
|xhr(ajax)| 17| 9  |  88.9%   |
|html     | 2 | 2  |  0%      |


####资源大小对比####


|      | 新版 | 旧版             |  增长比例|
|----- |----- | ---------------- |  ------- |
|大小| 2.1M  | 2.1M       |  0%      |
|js    | 100K    | 82.9K    |  20.6% | 
|css   | 10.9K    | 9.2K    |  18.5% |  
|图片  | 1.9M   | 2.0M      |  -5%   |  
|xhr(ajax)| 67K| 26.2K      |  156%  |  
|html     | 6.3K | 6.5K     |  -3%   |  


####新版资源####

![新版资源比例对比](images/compare.jpg?raw=true)

####页面加载时间对比####


|          | 新版  | 旧版             |   增长比例  |
|-------   |-------| ---------------- |  -------    |
|  load    | 1.32s | 747ms            |  76.7%      |
|  DOMContentLoaded | 636ms | 609ms   |  4.4%       |

 
 
 * load 页面所有资源下载完毕
 * DOMContentLoaded DOM文档加载完毕


####结论####
从以上数据统计表格中，我们可以得出以下结论：新版相比旧版慢

原因分析如下：
新版设计, 接口请求数增加，图片资源请求数量也相应增加，从而导致页面整体加载时间变慢
（新首页添加了多了“精选软件”，“精选游戏”，“软件、游戏分类”，“专题详情”等分类，在http请求数上，有33.3%的增长）

####前端已经做的优化####

1. 减少http请求，js从原有的7个请求，压缩到5个请求，使用css雪碧图
2. 加快页面首屏显示时间，所有css都至于页面头部，js都至页面底
3. 从感官视觉上提高页面呈现速度，在界面元素加载完毕后，马上关闭loading窗口


####其它优化建议####

1. 添加js，css，图片`永久缓存`
    前端通过计算js，css文件的sha1值，生成文件名，因此服务器设置永久缓存，减少http请求，加快页面渲染

2. `图片压缩`，对于应用图片，banner图片使用`png无损压缩`或`有损压缩`，压缩后可以节省60%以上带宽

3. 应用图标添加`缓存头`, 由于大部分图片资源是应用图标，一经生成，很少会修改或就算修改，图标名字也会变，因此建议服务器添加永久缓存头

![压缩节省531K带宽](images/图片压缩.jpg?raw=true)



